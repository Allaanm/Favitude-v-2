{% extends 'Favitude/base.html' %}
{% load static %}

{% block title %}Login - Favitude{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block content %}
<div class="login-page-wrapper">
    <div id="div1">
        <p id="p1">Sign in with</p>
        <div id="div1a">
            <a href=""><img src="{% static 'images/images-login/facebook.png' %}" alt="Facebook"></a>
            <a href=""><img src="{% static 'images/images-login/google.png' %}" alt="Google"></a>
            <a href=""><img src="{% static 'images/images-login/microsoft.png' %}" alt="Microsoft"></a>
        </div>

        <div id="div1b">
            <div id="div1c"></div>
            <div id="div1d">
                <p id="p2">or Sign in with Email</p>
            </div>
            <div id="div1e"></div>
        </div>

        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div>{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}

        <form id="form" action="{% url 'Hill:login_page' %}" method="POST" onsubmit="return check()" novalidate>
            {% csrf_token %}

            <label for="fmail">
                <p>Email Address</p>
                <input type="text" name="username" id="fmail" class="fields" placeholder="" onkeyup="manageBtn()">
                <div id="erroremail" class="emsg"></div>
            </label>

            <label for="pass">
                <p>Password</p>
                <input type="password" name="password" id="pass" class="fields" placeholder="Min. 8 characters" required
                    minlength="8" onkeyup="manageBtn()">
                <div id="errorpass" class="emsg"></div>
            </label>

            <div id="div1f">
                <div class="checkbox-rect2">
                    <input type="checkbox" id="checkbox-rect2" name="check">
                    <label for="checkbox-rect2">Remember me</label>
                </div>
                <div class="forgot1">
                    <a href="{% url 'password_reset' %}" id="forgot">Forgot Password?</a>
                </div>
            </div>

            <button type="submit" id="btnSubmit" class="submit" disabled>Log In</button>
        </form>

        <p id="p3">Not registered yet? <a href="{% url 'Hill:signup_page' %}" id="create">Create an account</a></p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const fmail = document.getElementById("fmail");
    const pass = document.getElementById("pass");
    const btnSubmit = document.getElementById("btnSubmit");
    const errorEmail = document.getElementById("erroremail");
    const errorPass = document.getElementById("errorpass");

    function check() {
        let valid = true;

        // Email validation (Basic HTML5 validity check)
        if (!fmail.checkValidity()) {
            valid = false;
            fmail.classList.add("err");
            errorEmail.innerText = "Please use a valid email address";
        } else {
            fmail.classList.remove("err");
            errorEmail.innerText = "";
        }

        // Password validation
        if (!pass.checkValidity()) {
            valid = false;
            pass.classList.add("err");
            errorPass.innerText = "Password must be at least 8 characters";
        } else {
            pass.classList.remove("err");
            errorPass.innerText = "";
        }

        return valid;
    }

    function manageBtn() {
        if (fmail.value.trim() !== '' && pass.value.trim() !== '') {
            btnSubmit.disabled = false;
        } else {
            btnSubmit.disabled = true;
        }
    }
</script>
{% endblock %}